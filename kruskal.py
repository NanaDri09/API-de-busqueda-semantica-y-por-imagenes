import numpy as np
from scipy.stats import kruskal
import pandas as pd

# -------------------------------
# 1. Datos
# -------------------------------
data = {
    'Hibrida_por_texto': [3749.473333, 2214.913368, 3869.554996, 2807.627439, 1624.725342, 
                          2039.379358, 2330.715656, 2085.193157, 2102.631092, 1650.941849,
                          2971.431255, 2403.391838, 2044.250488, 1986.176014, 1742.789268,
                          3571.40255, 2339.571476, 1405.966759, 2284.058332, 2205.309868],
    
    'Semantica': [2337.920427, 1658.061743, 4039.673605, 2367.377996, 1789.17551, 
                  2636.481285, 1812.305212, 1597.095966, 2872.093916, 4479.354858,
                  2617.270708, 2243.708611, 3050.181866, 2424.010038, 8115.447521,
                  18457.8526, 7480.99494, 9878.285408, 1859.395268, 10758.85224],
    
    'BM25': [122.3797798, 2.673625946, 3.871679306, 1.789331436, 1.755952835, 
             2.00343132, 2.145528793, 1.321315765, 0.980615616, 2.007246017,
             1.580476761, 2.014636993, 1.721658978, 2.403497696, 1.106262207,
             1.721382141, 2.175331116, 1.029014587, 2.647399902, 2.128839493],
    
    'RRF': [1402.699947, 2111.261129, 2217.890978, 1703.918219, 9855.326414, 
            5229.185581, 7195.784388, 6723.694324, 2601.258039, 3962.195158,
            4762.002945, 4020.727634, 3040.581942, 4118.658304, 2721.284151,
            2912.617922, 3022.968531, 2169.899702, 1900.454521, 3149.855137],
    
    'Multi-stage': [3233.920813, 2866.203547, 1738.847733, 2547.052383, 2239.471912, 
                    2268.9116, 2692.039967, 5466.775417, 2291.193485, 2642.454147,
                    4815.944433, 1914.433718, 3484.424101, 2400.858164, 2498.087168,
                    3907.11689, 1980.561018, 1867.308817, 1750.705481, 2179.200172],
    
    'Imagenes': [1530.201912, 381.465435, 311.2781048, 295.5157757, 1208.086729, 
                 279.0541649, 257.4284077, 305.9773445, 244.3420887, 252.4869442,
                 374.2022514, 259.0768337, 258.7718964, 339.621067, 262.3782158,
                 226.690144, 245.9828854, 303.9262295, 351.8538475, 251.0898113],
    
    'Caption': [188880.6095, 71476.57037, 19895.19167, 21935.70185, 199133.5418, 
                23470.89958, 104580.9388, 207400.4743, 70574.78571, 74568.52245,
                24858.48951, 24891.2518, 24502.27904, 103683.2569, 24858.48951,
                147458.554, 32781.34966, 55995.0428, 19140.43689, 28092.94891],
    
    'Descripciones': [166551.9416, 101589.1635, 27747.83874, 184265.1687, 196371.4902, 
                      26384.30572, 63209.64932, 152247.7508, 22864.74085, 23067.90018,
                      21905.48801, 25928.41077, 13928.01077, 120574.8222, 29237.1569,
                      186551.8254, 122466.9645, 547555.4242, 100525.8923, 132474.9673],
    
    'Hibrida_por_imagenes': [161669.683, 132950.402, 40401.89695, 37486.2299, 213091.3808, 
                             46794.27028, 176359.9777, 50401.89695, 186029.0542, 98090.7228,
                             59431.82595, 52620.73159, 186200.9439, 110259.3064, 77286.2299,
                             117383.0194, 121972.5568, 77843.3795, 40255.86009, 52959.84387]
}

# -------------------------------
# 2. Kruskal–Wallis
# -------------------------------
samples = list(data.values())

stat, p = kruskal(*samples)

print("\n=== KRUSKAL–WALLIS ===")
print(f"H statistic = {stat:.4f}")
print(f"p-value     = {p:.6e}")

if p < 0.05:
    print("Resultado: Existen diferencias estadísticamente significativas entre los métodos.")
else:
    print("Resultado: No se detectan diferencias estadísticamente significativas.")

# -------------------------------
# 3. Tabla descriptiva
# -------------------------------
df = pd.DataFrame(data)

summary = pd.DataFrame({
    "Mediana": df.median(),
    "Media": df.mean(),
    "Std": df.std()
}).sort_values("Mediana", ascending=False)

print("\n=== Estadísticas descriptivas ===")
print(summary)
